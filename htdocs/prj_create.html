<!doctype html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/style.css">
    <title>Hackathon</title>
</head>

<body>
    <header class="navbar text-light bg-dark">
        <div class="container-fluid">
            <b class="fs-4">Hackathon Mine</b>
        </div>
    </header>
    <div class="container-fluid">
        <nav class="my-4" style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/">TOP</a></li>
                <li class="breadcrumb-item active" aria-current="page">新規プロジェクト</li>
            </ol>
        </nav>
        <form enctype="multipart/form-data" class="mt-5 entry-form" action="/" method="post">
            
            <div class="mb-4">
                <label for="project_name" class="form-label">プロジェクト名</label>
                <input type="text" name="project_name" class="form-control">
            </div>
            <div class="mb-4">
                <label for="responsible_person" class="form-label">責任者</label>
                <select class="form-select" aria-label="">
                    <option selected>-</option>
                    <option value="1">笹本健</option>
                    <option value="2">山田太郎</option>
                    <option value="3">鈴木一郎</option>
                </select>
            </div>
            <div class="mb-4">
                <label for="start_date" class="form-label">メンバー</label>
                <div class="mb-3">
                    <input type="checkbox" class="form-check-input" id="select-all">
                    <label for="select-all" class="form-check-label">全て</label>
                </div>
                <div class="mb-1">
                    <input type="checkbox" class="form-check-input" name="user_name[]" value="1">
                    <label class="form-check-label">笹本 健</label>
                </div>
                <div class="mb-1">
                    <input type="checkbox" class="form-check-input" name="user_name[]" value="2">
                    <label class="form-check-label">山田太郎</label>
                </div>
                <div class="mb-1">
                    <input type="checkbox" class="form-check-input" name="user_name[]" value="3">
                    <label class="form-check-label">鈴木一郎</label>
                </div>
            </div>
            
            <div class="d-flex justify-content-center complete-btn-grp pt-5 mb-5">
                <button type="submit" class="btn btn-primary me-3"><b>保存</b></button>
                <div><a class="text-light btn btn-secondary me-3" href="/"><b>戻る</b></a></div>
            </div>
        </form>
    </div>
        <script>
            // メンバー追加と削除
            function addMember() {
                
                // プルダウンで選択されたメンバーの名前を取得
                var memberSelect = document.getElementById("member-select");
                var selectedOption = memberSelect.options[memberSelect.selectedIndex];

                  // value属性のない選択肢は追加できないようにする
                if (selectedOption.value == 0) {
                    return;
                }

                var memberName = selectedOption.text;
                var memberId = selectedOption.value;

                  // プルダウンで選択されたメンバーの項目を非表示にする
                selectedOption.style.display = "none";

                // メンバー一覧に追加
                var memberList = document.getElementsByClassName("member-list")[0];
                var memberNameDiv = document.createElement("div");
                memberNameDiv.className = "pb-1 member-name";
                memberNameDiv.innerHTML = '<span>' + memberName + '</span><input type="hidden" name="user_name[]" class="form-control" value="' + memberId + '"><a class="ps-3" href="javascript:void(0)">削除</a>';
                memberList.appendChild(memberNameDiv);
                
                // 削除ボタンを押したときの処理
                var deleteBtn = memberNameDiv.getElementsByTagName("a")[0];
                
                deleteBtn.onclick = function() {
                    memberList.removeChild(memberNameDiv);
                    // 削除されたメンバーの項目を再表示する
                    selectedOption.style.display = "";
                    // プルダウンをデフォルトにリセットする
                    memberSelect.selectedIndex = 0;
                };

                // プルダウンをデフォルトにリセットする
                memberSelect.selectedIndex = 0;
            }

            // 「全選択」チェックボックスの要素を取得
            var selectAllCheckbox = document.getElementById("select-all");

            // 「全選択」チェックボックスが変更された時の処理
            selectAllCheckbox.addEventListener("change", function () {
                var checkboxes = document.querySelectorAll('input[name="user_name[]"]');

                if (selectAllCheckbox.checked) {
                    // 「全選択」がチェックされた場合、すべてのチェックボックスを選択状態にする
                    checkboxes.forEach(function (checkbox) {
                        checkbox.checked = true;
                    });
                } else {
                    // 「全選択」がチェック解除された場合、すべてのチェックボックスの選択を解除する
                    checkboxes.forEach(function (checkbox) {
                        checkbox.checked = false;
                    });
                }
            });
        </script>
</body>

</html>